getwd()
setwd("/Users/meixian/Desktop/DataAnalysis/R/Wine")
getwd()
# Load all of the packages that you end up using in your analysis in this code
# chunk.
# Notice that the parameter "echo" was set to FALSE for this code chunk. This
# prevents the code from displaying in the knitted HTML output. You should set
# echo=FALSE for all code chunks in your file, unless it makes sense for your
# report to show the code that generated a particular plot.
# The other parameters for "message" and "warning" should also be set to FALSE
# for other code chunks once you have verified that each plot comes out as you
# want it to. This will clean up the flow of your report.
library(ggplot2)
library(GGally)
library(reshape2)
library(gridExtra)
library(grid)
library(corrplot)
library(scatterplot3d)
library(RColorBrewer)
# Load all of the packages that you end up using in your analysis in this code
# chunk.
# Notice that the parameter "echo" was set to FALSE for this code chunk. This
# prevents the code from displaying in the knitted HTML output. You should set
# echo=FALSE for all code chunks in your file, unless it makes sense for your
# report to show the code that generated a particular plot.
# The other parameters for "message" and "warning" should also be set to FALSE
# for other code chunks once you have verified that each plot comes out as you
# want it to. This will clean up the flow of your report.
library(ggplot2)
library(GGally)
library(reshape2)
library(gridExtra)
library(grid)
library(corrplot)
library(scatterplot3d)
library(RColorBrewer)
?factor
# Load the Data
red = read.csv("wineQualityReds.csv",header = T)
#factorize quality variable and use it as a parameterize the color in the plotting
red$quality_factor = factor(red$quality)
head(red)
str(red)
# Load all of the packages that you end up using in your analysis in this code
# chunk.
# Notice that the parameter "echo" was set to FALSE for this code chunk. This
# prevents the code from displaying in the knitted HTML output. You should set
# echo=FALSE for all code chunks in your file, unless it makes sense for your
# report to show the code that generated a particular plot.
# The other parameters for "message" and "warning" should also be set to FALSE
# for other code chunks once you have verified that each plot comes out as you
# want it to. This will clean up the flow of your report.
library(ggplot2)
library(GGally)
library(reshape2)
library(gridExtra)
library(grid)
library(corrplot)
library(scatterplot3d)
library(RColorBrewer)
# Load the Data
red = read.csv("wineQualityReds.csv",header = T)
str(red)
#factorize quality variable and use it as a parameterize the color in the plotting
red$quality_factor = factor(red$quality)
summary(red[2:13])
q1 = ggplot(aes(x= fixed.acidity), data = red)+
geom_histogram(color='gray')
q2 = ggplot(aes(x= volatile.acidity), data = red)+
geom_histogram(color='gray')
q3 = ggplot(aes(x= citric.acid), data = red)+
geom_histogram(color='gray')
q4 = ggplot(aes(x= residual.sugar), data = red)+
geom_histogram(color='gray')
q5 = ggplot(aes(x= chlorides), data = red)+
geom_histogram(color='gray')
q6 = ggplot(aes(x= free.sulfur.dioxide), data = red)+
geom_histogram(color='gray')
q7 = ggplot(aes(x= total.sulfur.dioxide), data = red)+
geom_histogram(color='gray')
q8 = ggplot(aes(x= density), data = red)+
geom_histogram(color='gray')
q9 = ggplot(aes(x= pH), data = red)+
geom_histogram(color='gray')
q10 = ggplot(aes(x= sulphates), data = red)+
geom_histogram(color='gray')
q11 = ggplot(aes(x= alcohol), data = red)+
geom_histogram(color='gray')
q12 = ggplot(aes(x= quality), data = red)+
geom_histogram(binwidth = 0.5, color='gray')
grid.arrange(q1,q2,q3,q4,q5,q6,q7,q8,q9,q10,q11,q12,nrow=3,ncol=4)
corMatrix =cor(red[2:13],method='pearson')
corrplot(corMatrix, type="lower")
ggplot(data=subset(red,!is.na(quality)), aes(y=alcohol,x=quality,color=quality_factor))+
geom_jitter()+
geom_boxplot(aes(group=(cut_width(quality,1))),alpha = 0.5)+
coord_flip()+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("---")
ggplot(data=subset(red,!is.na(quality)), aes(y=sulphates,x=quality,color=quality_factor))+
geom_jitter()+
geom_boxplot(aes(group=(cut_width(quality,1))),alpha = 0.5)+
coord_flip()+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("---")
ggplot(data=subset(red,!is.na(quality)), aes(y=citric.acid,x=quality,color=quality_factor))+
geom_jitter()+
geom_boxplot(aes(group=(cut_width(quality,1))),alpha = 0.5)+
coord_flip()+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("---")
ggplot(data=subset(red,!is.na(quality)), aes(x=citric.acid,y=volatile.acidity,color=quality_factor))+
geom_point(alpha = 0.7)+
scale_color_brewer(type = 'div',palette = 4) +
xlim(c(0.20,1.6))
ggplot(data=subset(red,!is.na(quality)), aes(x=citric.acid,y=volatile.acidity,color=quality_factor))+
geom_point(alpha = 0.7)+
scale_color_brewer(type = 'div',palette = 4)
ggplot(data=subset(red,!is.na(quality)), aes(x=sulphates,y=alcohol,color=quality_factor))+
geom_point(alpha = 0.7)+
scale_color_brewer(type = 'div',palette = 4) +
xlim(c(0.20,1.6))+
ggtitle("---")
ggplot(data=subset(red,!is.na(quality)), aes(x=citric.acid,y=alcohol,color=quality_factor))+
geom_point(alpha = 0.7)+
scale_color_brewer(type = 'div',palette = 4) +
xlim(c(0.20,1.6))+
ggtitle("---")
ggplot(data=subset(red,!is.na(quality)), aes(x=citric.acid,y=alcohol,color=quality_factor))+
geom_point(alpha = 0.7)+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("---")
ggplot(data=subset(red,!is.na(quality)), aes(x=alcohol,y=volatile.acidity,color=quality_factor))+
geom_point()+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("---")
ggplot(data=subset(red,!is.na(quality)), aes(y=alcohol,x=quality,color=quality_factor))+
geom_jitter()+
geom_boxplot(aes(group=(cut_width(quality,1))),alpha = 0.5)+
coord_flip()+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("Alcohol levels in red wines VS. qualities")
ggplot(data=subset(red,!is.na(quality)), aes(y=alcohol,x=quality,color=quality_factor))+
geom_jitter()+
geom_boxplot(aes(group=(cut_width(quality,1))),alpha = 0.5)+
coord_flip()+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("Alcohol levels in red wines VS. qualities")+
theme_update(plot.title = element_text(hjust = 0.5))
ggplot(data=subset(red,!is.na(quality)), aes(y=alcohol,x=quality,color=quality_factor))+
geom_jitter()+
geom_boxplot(aes(group=(cut_width(quality,1))),alpha = 0.5)+
coord_flip()+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("Alcohol levels in red wines VS. qualities")+
theme_update(plot.title = element_text(hjust = 1))
ggplot(data=subset(red,!is.na(quality)), aes(y=volatile.acidity,x=quality,color=quality_factor))+
geom_jitter()+
geom_boxplot(aes(group=(cut_width(quality,1))),alpha = 0.5)+
coord_flip()+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("Volatile acidity levels in red wines VS. qualities)
ggplot(data=subset(red,!is.na(quality)), aes(y=volatile.acidity,x=quality,color=quality_factor))+
geom_jitter()+
geom_boxplot(aes(group=(cut_width(quality,1))),alpha = 0.5)+
coord_flip()+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("Volatile acidity levels in red wines VS. qualities")
ggplot(data=subset(red,!is.na(quality)), aes(y=volatile.acidity,x=quality,color=quality_factor))+
geom_jitter()+
geom_boxplot(aes(group=(cut_width(quality,1))),alpha = 0.5)+
coord_flip()+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("Volatile acidity levels in red wines VS. qualities")
ggplot(data=subset(red,!is.na(quality)), aes(y=alcohol,x=quality,color=quality_factor))+
geom_jitter()+
geom_boxplot(aes(group=(cut_width(quality,1))),alpha = 0.5)+
coord_flip()+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("Alcohol levels in red wines VS. qualities")+
theme_update(plot.title = element_text(hjust = 0.5))
ggplot(data=subset(red,!is.na(quality)), aes(y=alcohol,x=quality,color=quality_factor))+
geom_jitter()+
geom_boxplot(aes(group=(cut_width(quality,1))),alpha = 0.5)+
coord_flip()+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("Alcohol levels in red wines VS. qualities")+
theme_update(plot.title = element_text(hjust = 0.5))
ggplot(data=subset(red,!is.na(quality)), aes(y=volatile.acidity,x=quality,color=quality_factor))+
geom_jitter()+
geom_boxplot(aes(group=(cut_width(quality,1))),alpha = 0.5)+
coord_flip()+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("Volatile acidity levels in red wines VS. qualities")
ggplot(data=subset(red,!is.na(quality)), aes(x=citric.acid,y=volatile.acidity,color=quality_factor))+
geom_point(alpha = 0.7)+
ylim(c(0,1))+
scale_color_brewer(type = 'div',palette = 4)
ggplot(data=subset(red,!is.na(quality)), aes(x=citric.acid,y=volatile.acidity,color=quality_factor))+
geom_point(alpha = 0.7)+
ylim(c(0.2,1))+
scale_color_brewer(type = 'div',palette = 4)
ggplot(data=subset(red,!is.na(quality)), aes(x=citric.acid,y=volatile.acidity,color=quality_factor))+
geom_point(alpha = 0.7)+
ylim(c(0.2,1))+
xlim(c(0,0.8))+
scale_color_brewer(type = 'div',palette = 4)
ggplot(data=subset(red,!is.na(quality)), aes(y=citric.acid,x=quality,color=quality_factor))+
geom_jitter()+
geom_boxplot(aes(group=(cut_width(quality,1))),alpha = 0.5)+
coord_flip()+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("Citric acid levels in red wines VS. qualities")
ggplot(data=subset(red,!is.na(quality)), aes(x=alcohol,y=volatile.acidity,color=quality_factor))+
geom_point()+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("---")
ggplot(data=subset(red,!is.na(quality)), aes(x=alcohol,y=volatile.acidity,color=quality_factor))+
geom_point()+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("Alcohol and volatile acidity level in red wines VS. quality")
legend("topright", inset=.05,      # location and inset
bty="n", cex=.8,              # suppress legend box, shrink text 50%
title="Quality of wine",
c("very good (8)", "very bad (3)"), fill=c("darkgoldenrod", "darkorchid4"))
red$quality_color[red$quality==3] = 'darkgoldenrod'
red$quality_color[red$quality==4] = 'navajowhite2'
red$quality_color[red$quality==7] = 'plum3'
red$quality_color[red$quality==8] = 'darkorchid4'
with(subset(red,!is.na(quality_color) & quality<4 | quality>7),{
wine3d <-scatterplot3d(volatile.acidity,citric.acid,alcohol,
color=quality_color,
type='h',
pch=19,
main="---")
wine3d.coords <- wine3d$xyz.convert(volatile.acidity,citric.acid,alcohol)
legend("topright", inset=.05,      # location and inset
bty="n", cex=.8,              # suppress legend box, shrink text 50%
title="Quality of wine",
c("very good (8)", "very bad (3)"), fill=c("darkgoldenrod", "darkorchid4"))
}
)
ggplot(data=subset(red,!is.na(quality)), aes(x=citric.acid,y=volatile.acidity,color=quality_factor))+
geom_point(alpha = 0.7)+
ylim(c(0.2,1))+
xlim(c(0,0.8))+
scale_color_brewer(type = 'div',palette = 4)
legend("topright", inset=.05,      # location and inset
bty="n", cex=.8,              # suppress legend box, shrink text 50%
title="Quality of wine",
c("very good (8)", "very bad (3)"), fill=c("darkgoldenrod", "darkorchid4"))
with(subset(red,!is.na(quality_color) & quality<4 | quality>7),{
wine3d <-scatterplot3d(volatile.acidity,citric.acid,alcohol,
color=quality_color,
type='h',
pch=19,
main="3D plot of good and bad wine vs. volatile.acidity,citric.acid and alcohol ")
wine3d.coords <- wine3d$xyz.convert(volatile.acidity,citric.acid,alcohol)
legend("topright", inset=.05,      # location and inset
bty="n", cex=.8,              # suppress legend box, shrink text 50%
title="Quality of wine",
c("very good (8)", "very bad (3)"), fill=c("darkgoldenrod", "darkorchid4"))
}
)
q12 = ggplot(aes(x= quality), data = red)+
geom_histogram(binwidth = 0.5, color='gray')
ggplot(aes(x= quality), data = red)+
geom_histogram(binwidth = 0.5, color='gray')
ggplot(aes(x= quality), data = red)+
geom_histogram(binwidth = 0.8, color='gray')
ggplot(aes(x= quality), data = red)+
geom_histogram(binwidth = 0.7, color='gray')
ggplot(aes(x= quality), data = red)+
geom_histogram(binwidth = 0.5, color='gray')
ggplot(aes(x= quality), data = red)+
geom_histogram(binwidth = 0.5, color='gray')+
breaks(c(3,4,5,6,7,8))
ggplot(aes(x= quality), data = red)+
geom_histogram(binwidth = 0.5, color='gray',breaks(c(3,4,5,6,7,8)))
ggplot(aes(x= quality), data = red)+
geom_histogram(binwidth = 0.5, color='gray',breaks=(c(3,4,5,6,7,8)))
ggplot(aes(x= quality), data = red)+
geom_histogram(binwidth = 0.5, color='gray')
ggplot(data=subset(red,!is.na(quality)),
aes(y=alcohol,x=quality,color=quality_factor))+
geom_jitter()+
geom_boxplot(aes(group=(cut_width(quality,1))),alpha = 0.5)+
coord_flip()+
scale_color_brewer(type = 'div',palette = 4) +
theme_update(plot.title = element_text(hjust = 0.5))+
ggtitle("Alcohol levels in red wines VS. quality")
ggplot(data=subset(red,!is.na(quality)),
aes(x=citric.acid,y=volatile.acidity,color=quality_factor))+
geom_point(alpha = 0.7)+
ylim(c(0.2,1))+
xlim(c(0,0.8))+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("citric acidity and volatile acidity level in red wines VS. quality")
ggplot(data=subset(red,!is.na(quality)),
aes(x=citric.acid,y=volatile.acidity,color=quality_factor))+
geom_point(alpha = 0.7)+
ylim(c(0.2,1))+
xlim(c(0,0.8))+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("citric acidity and volatile acidity level in red wines VS. quality")
```{r echo=FALSE,warning=FALSE, message=FALSE, Plot_Three}
ggplot(data=subset(red,!is.na(quality)),
aes(x=citric.acid,y=volatile.acidity,color=quality_factor))+
geom_point(alpha = 0.7)+
ylim(c(0.2,1))+
xlim(c(0,0.8))+
scale_color_brewer(type = 'div',palette = 4) +
ggtitle("citric acidity and volatile acidity level in red wines VS. quality")
